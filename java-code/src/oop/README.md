### 문제: 쇼핑몰 주문 및 배송 시스템

다음과 같은 요구사항을 가진 쇼핑몰의 주문 및 배송 시스템이 있습니다.

1. **주문 생성**: 사용자는 여러 상품을 담아 주문을 생성할 수 있습니다. 각 상품은 가격과 재고를 가집니다.
2. **재고 관리**: 주문이 생성될 때, 각 상품의 재고를 감소시켜야 합니다. 재고가 부족한 상품이 하나라도 있다면 주문을 실패시키고, 어떤 상품이 재고 부족인지 사용자에게 알려야 합니다.
3. **배송비 계산**: 총주문 금액에 따라 배송비가 다르게 책정됩니다.
    - 총주문 금액이 5만 원 미만이면 배송비는 3,000원입니다.
    - 총주문 금액이 5만 원 이상이면 배송비는 무료입니다.
4. **주문 상태 관리**: 주문은 `CREATED`, `SHIPPING`, `DELIVERED`, `CANCELLED`와 같은 여러 상태를 가집니다.
5. **주문 취소**: `CREATED` 상태인 주문만 취소할 수 있습니다. 주문이 취소되면 감소했던 상품의 재고를 원상 복구해야 합니다.

### TDA와 SOLID 원칙을 위반한 코드 (Refactoring Target)

요구사항을 구현했지만, **TDA(Tell, Don't Ask)**와 **SOLID** 원칙을 제대로 지키지 못하고 있습니다.

코드를 TDA와 SOLID 원칙을 적용하여 리팩터링해 주세요.

- **TDA**: `OrderService`가 `Product`와 `Order`의 내부 상태를 직접 '묻고' 로직을 처리하는 부분을 객체 스스로가 '명령'을 받아 처리하도록 변경해 보세요.
- **SOLID**: 특히 **단일 책임 원칙(SRP)**과 **개방-폐쇄 원칙(OCP)**을 고려하여 객체들의 책임을 명확히 분리하고, 새로운 로직이 추가될 때 기존 코드를 수정하지 않아도 되는 구조로 개선해 보세요.